<!-- visitor-dashboard.component.html -->
<div class="p-6">
    <h1 class="text-2xl font-bold mb-16">Welcome Back, Ahmed!</h1>
    
    <div class="mb-8">
      <h2 class="text-2xl font-bold mb-8">View your communities :</h2>
    </div>
    
    <!-- PrimeNG Carousel with Tailwind classes -->
    <div class="relative px-8">
      <p-carousel [value]="communities" [numVisible]="3" [numScroll]="1" 
        [responsiveOptions]="responsiveOptions" styleClass="communities-carousel"
        [showNavigators]="true" [showIndicators]="false">
        
        <ng-template pTemplate="item" let-community>
          <div class="mx-2 shadow-md rounded-lg overflow-hidden bg-white border border-gray-200 max-w-[280px]">
            <!-- Card Header with Chip Icon -->
            <div class="bg-[#c8c788] h-24 flex items-center justify-center">
             <img src="../../../../assets/image.png" alt="" class="max-h-fit">
            </div>
            
            <!-- Card Content -->
            <div class="p-4 text-center mt-4">
              <h3 class="text-xl font-medium mb-2">{{community.name}}</h3>
              <p class="text-gray-600 text-sm mb-4">
                {{community.description}}
              </p>
              
              <!-- Member Count -->
              <div class="flex justify-center items-center mb-3">
                <i class="pi pi-users mr-1 text-gray-600"></i>
                <span class="text-sm text-black font-bold">x{{community.members}}</span>
              </div>
              
              <!-- View Button with inline styling -->
              <button pButton type="button" label="View" 
                class="p-button-rounded"
                [ngStyle]="{
                  'background-color': '#e9d18c',
                  'border': 'none',
                  'color': 'black',
                  'font-weight': 'normal',
                  'padding': '0.4rem 1.5rem'
                }">
              </button>
            </div>
          </div>
        </ng-template>
      </p-carousel>
    </div>
  </div>
  
  <!-- Upcoming events  -->

<div class="p-6">
    <h2 class="text-2xl font-bold mb-8">Upcoming events :</h2>
    
    <!-- PrimeNG Carousel for Events -->
    <div class="relative px-8 ">
      <p-carousel [value]="events" [numVisible]="3" [numScroll]="1" 
        [responsiveOptions]="responsiveOptions" styleClass="events-carousel"
        [showNavigators]="true" [showIndicators]="false">
        
        <!-- Updated event card to match all-events component -->
        <ng-template pTemplate="item" let-event>
          <div class="mx-2 shadow-md rounded-lg overflow-hidden bg-white border border-gray-200 h-[22rem]">
            <!-- Event Image -->
            <div class="h-40 overflow-hidden">
              <img [src]="event.imageUrl" alt="Event image" class="w-full h-full object-cover">
            </div>
            
            <!-- Event Content -->
            <div class="p-4 text-center ">
              <h3 class="text-xl font-bold mb-2">{{event.title}}</h3>
              
              <!-- Date and Time -->
              <div class="flex justify-center items-center mb-2">
                <span class="text-sm text-gray-600">{{event.date}}, {{event.time}}</span>
              </div>
              
              <!-- Location -->
              <div class="flex justify-center items-center mb-4">
                <span class="text-sm text-gray-600">{{event.location}}</span>
              </div>
              
              <!-- See Details Button -->
              <button 
                pButton 
                type="button" 
                label="See Details" 
                class="p-button-rounded"
                [ngStyle]="{
                  'background-color': '#E69B6B',
                  'border': 'none',
                  'color': 'white',
                  'font-weight': 'normal',
                  'padding': '0.4rem 1.5rem'
                }"
                (click)="showEventDetails(event)"
              ></button>
            </div>
          </div>
        </ng-template>
      </p-carousel>
    </div>
  </div>
  
  <!-- Event Details Modal (copied from all-events component) -->
  <p-dialog 
    [(visible)]="displayEventModal" 
    [modal]="true" 
    [style]="{width: '450px'}" 
    [draggable]="false" 
    [resizable]="false"
    [closeOnEscape]="true"
    [showHeader]="false"
    styleClass="p-0"
  >
    <div class="relative p-6" *ngIf="selectedEvent">
      <!-- Close button -->
      <button 
        type="button" 
        class="absolute top-5 right-1 text-gray-600 hover:text-gray-800 bg-transparent border-0"
        (click)="displayEventModal = false"
      >
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>    </button>
      
      <!-- Private badge -->
      <div class="mb-4 text-center" *ngIf="selectedEvent.isPrivate">
       <p class="bg-green-200 text-gray-700 text-sm inline-block px-3 py-1 rounded-md ">Private</p> 
      </div>
      
      <!-- Event Title -->
      <h2 class="text-xl font-bold mb-4">{{selectedEvent.title}}</h2>
      
      <!-- Event Description -->
      <p class="text-gray-600 mb-6">
        {{selectedEvent.description}}
      </p>
      
      <!-- Date & Time -->
      <div class="flex items-center justify-center mb-6 border-[1px] bg-gray-100 rounded-lg border-gray-200 hover:border-gray-300">
        <div class="flex items-center justify-center w-8 h-8 mr-3">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M580-240q-42 0-71-29t-29-71q0-42 29-71t71-29q42 0 71 29t29 71q0 42-29 71t-71 29ZM200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Z"/></svg>      </div >
        <span class="text-gray-800">{{selectedEvent.date}}, {{selectedEvent.time}}</span>
      </div>
      
      <!-- Location -->
      <div class="flex items-center justify-center mb-6 border-[1px] bg-gray-100 rounded-lg border-gray-200 hover:border-gray-300">
        <div class="flex items-center justify-center w-8 h-8 mr-3">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"/></svg>      </div>
        <span class="text-gray-800">{{selectedEvent.location}}</span>
      </div>
      
      <!-- Spots left -->
      <div class="flex items-center justify-center mb-6 border-[1px] bg-gray-100 rounded-lg border-gray-200 hover:border-gray-300">
        <div class="flex items-center justify-center w-8 h-8 mr-3">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>      </div>
        <span class="text-gray-800">Spots left: {{getSpotsLeft(selectedEvent)}}</span>
      </div>
      
      <!-- Book Event Button -->
      <div class="text-center">
        <button 
          pButton 
          type="button" 
          label="Book Event" 
          class="p-button-rounded"
          [ngStyle]="{
            'background-color': '#E69B6B',
            'border': 'none',
            'color': 'white',
            'font-weight': 'normal',
            'padding': '0.5rem 2rem'
          }"
        ></button>
      </div>
    </div>
  </p-dialog>